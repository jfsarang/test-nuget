trigger:
  branches:
      include:
      - master


steps:
- task: JFrogToolsInstaller@1
  inputs:
    artifactoryConnection: 'sarangeplus'
    cliInstallationRepo: 'jfrog-cli-remote'
    installCustomVersion: true
    cliVersion: '2.37.3'
    installExtractors: true
    extractorsInstallationRepo: 'extractors'
- script: |
    # Look for nuget.exe in common locations
    Get-ChildItem -Path "$env:ProgramFiles\NuGet" -Filter "nuget.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName
    Get-ChildItem -Path "$env:ProgramFiles(x86)\NuGet" -Filter "nuget.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName
    Get-ChildItem -Path "$env:Agent.ToolsDirectory" -Filter "nuget.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName
    Get-ChildItem -Path "$env:SystemDrive\NuGet" -Filter "nuget.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName
    displayName: 'Search for nuget.exe'
- task: JFrogNuGet@1
  inputs:
    command: 'restore'
    artifactoryConnection: 'sarangeplus'
    targetResolveRepo: 'nuget-virtual'
    solutionPath: '**/*.sln'
    noNuGetCache: true
    collectBuildInfo: true
    buildName: 'bmp-nuget-demo'
    nugetProtocolVersion: v2
    
